\chapter{Parameter and table choice}
\label{ch:param}
For the Time-Memory trade-off attack to viable, the right set of
parameters and the right table choice is of huge importance. In this
attack we would ideally want to perform the online phase of the  attack on a modern
high-end laptop/desktop machine. For this to be possible, the right
trade-off between time and memory is needed. For an attack on the
cipher with \code{64-bit} key size, we know a large table is required. But if
we want to make it possible to perform the attack on a (heavily
upgraded) consumer
machine, we need to set an upper bound for the maximal memory
usage. In our attack we set an upper bound of memory usage to around
\code{8TB} of tables[TODO cite to HDD sizes]. We see this as a possible amount of storage if a
consumer machine with a TMTO-attack in mind was to be build.

Knowing this and taking the theory behind the
TMTO-attack\footnote{Chapter \ref{ch:tmto}} into consideration, we
have to argue that this upper bound is required to be hit. For every
trade-off we take towards lower memory usage, the online phase of the
attacks will take a hit.

Another thing to take into consideration when analyzing the parameter
choice and time consumption of the different phases is the table lookup
time. Since generated TMTO tables for a \code{64-bit} key size will
always be larger than a given built machines amount of RAM, look-ups are
done directly on a HDD or SSD. Estimates of how much time is required
for each lookup in a table is hard to do, but will be further analyzed
in TODO SOMEWHERE?

As for success probability of the
the different attacks, we went with $P = 73\%$ as an acceptable
success rate.
We witnessed that for a probability of above $73\%$ the increase,
in both pre-computational cost and the time of the online phase, would
make our initial idea of running the attack on a consumer made PC
unfeasible.

In the following sections we will go through our computations of
parameters for the different TMTO-attacks with these limits set.

\section{Hellman Table}
All calculations of parameters follows the theory provided in
\ref{sec:hmtheory}.

Concidering the theory and above mentioned formulas, a approximation of the best parameters for a $73\%$ success rate table can be made.
As stated earlier the memory requirements will meet the upper bound of
\code{8TB}.
As the success probability already is set we can find the respective parameters and compare them.

TODO We need to show where we get this stuff from.. reference
formulas...
\begin{figure}[H]
  \centering
  \begin{minipage}{0.45\textwidth}
    \centering
    \includegraphics[width=1.2\textwidth]{figures/HellmanTradeOff.png}
    \captionof{figure}{Figure from \cite{176}}
    \label{fig:hellTC}
  \end{minipage}\hfill
  \begin{minipage}{0.45\textwidth}
    \centering
    \includegraphics[width=1.2\textwidth]{figures/compareHmsc.png}
    \captionof{figure}{$H_{msc}$ from 0.75 to 2.75}
    \label{fig:hellHmsc}
  \end{minipage}
\end{figure}
As we know from \cite{176} a lower trade-off coefficient results in a
better trade-off. Figure \ref{fig:hellHmsc} shows a graph of the
trade-off coefficient for a set success rate and $H_{msc}$.
As seen on \ref{fig:hellTC} the best possible trade-off is achieved
when $H_{msc}$ is between 1 and 2.25. This is further shown in
\ref{fig:hellHmsc} where, as $H_{msc}$ grows, the smaller the memory
required for the tables get. This effect decreases as $H_{msc}$ grows
larger than 2.25. A side effect of an increasing $H_{msc}$ is it's
influence on the pre-computational cost and the efficiency of the
trade-off. The optimal value of $H_{msc}$ is when the trade-off
efficiency is lowest. An $H_{msc}$ set to $2.25$ makes for the most
efficient trade-off.

Table \ref{tab:hellparam} shows a generated table of Hellman
parameters for $H_{msc} =2.25$.
\begin{table}[H]
  \centering
  \text{\texttt{Success{ }={ }0.73,{ }Hmsc{ }={ }2.25,{ }Hcr{ }={ }0.74,{ }Htc{ }={ }1.88{ }Hpc{ }={ }1.77} }
\begin{tabular}{lllll}
m & t & l & M in TB & T \\\hline
$2^{10.00}$ & $2^{27.58}$ & $2^{26.63}$ & $1.70$ & $2^{54.10}$ \\
$2^{10.50}$ & $2^{27.33}$ & $2^{26.38}$ & $2.02$ & $2^{53.60}$ \\
$2^{11.00}$ & $2^{27.08}$ & $2^{26.13}$ & $2.41$ & $2^{53.10}$ \\
$2^{11.50}$ & $2^{26.83}$ & $2^{25.88}$ & $2.86$ & $2^{52.60}$ \\
$2^{12.00}$ & $2^{26.58}$ & $2^{25.63}$ & $3.40$ & $2^{52.10}$ \\
$2^{12.50}$ & $2^{26.33}$ & $2^{25.38}$ & $4.05$ & $2^{51.60}$ \\
$2^{13.00}$ & $2^{26.08}$ & $2^{25.13}$ & $4.81$ & $2^{51.10}$ \\
$2^{13.50}$ & $2^{25.83}$ & $2^{24.88}$ & $5.72$ & $2^{50.60}$ \\
$2^{14.00}$ & $2^{25.58}$ & $2^{24.63}$ & $6.81$ & $2^{50.10}$ \\
$2^{14.50}$ & $2^{25.33}$ & $2^{24.38}$ & $8.09$ & $2^{49.60}$ \\
\end{tabular}
  \caption{Hellman Parameters}
  \label{tab:hellparam}
\end{table}

TODO CHOOSE VALUES

\section{Distinguished Points Table}
TODO Needs more work

For this section we assume that $\hat{t}$ is sufficiently large.

All calculations of parameters follows the theory provided in
\ref{sec:dptheory}.

Again we use the set upper bound for the memory and our set $P$.

TODO We need to show where we get this stuff from.. reference
formulas...

As shown in \ref{fig:dpHmsc} the smaller the matrix stopping constant
gets the bigger the table gets, The time memory coefficient is most
efficient at 0.56 \cite{176}. Which also states that a $D_{msc}$ above
0.56 should be avoided. Therefore the matrix stopping constant has been
set to 0.56, using the formulas for optimal parameters from \cite{176}
\ref{tab:DPparam} is generated.
\begin{figure}[H]
  \centering
  need to put lables on the elements from left to right 0.2, 0.3, 0.56, 0.75, 1.00, 1.25
    \includegraphics[width=0.5\textwidth]{figures/compareDmsc.png}
    \captionof{figure}{$D_{msc}$ from 0.2 to 1}
    \label{fig:dpHmsc}
\end{figure}
\begin{table}[H]
  \centering
  \text{\texttt{Success{ }={ }0.73,{ }Dmsc{ }={ }0.56,{ }Dcr{ }={ }0.81,{ }Dtc{ }={ }8.77{ }Dpc{ }={ }1.60} }
\begin{tabular}{lllll}
m & t & l & M in TB & T \\\hline
$2^{10.00}$ & $2^{26.58}$ & $2^{28.10}$ & $2.36$ & $2^{54.69}$ \\
$2^{10.50}$ & $2^{26.33}$ & $2^{27.85}$ & $2.81$ & $2^{54.19}$ \\
$2^{11.00}$ & $2^{26.08}$ & $2^{27.60}$ & $3.34$ & $2^{53.69}$ \\
$2^{11.50}$ & $2^{25.83}$ & $2^{27.35}$ & $3.97$ & $2^{53.19}$ \\
$2^{12.00}$ & $2^{25.58}$ & $2^{27.10}$ & $4.72$ & $2^{52.69}$ \\
$2^{12.50}$ & $2^{25.33}$ & $2^{26.85}$ & $5.61$ & $2^{52.19}$ \\
$2^{13.00}$ & $2^{25.08}$ & $2^{26.60}$ & $6.67$ & $2^{51.69}$ \\
$2^{13.50}$ & $2^{24.83}$ & $2^{26.35}$ & $7.94$ & $2^{51.19}$ \\
$2^{14.00}$ & $2^{24.58}$ & $2^{26.10}$ & $9.44$ & $2^{50.69}$ \\
$2^{14.50}$ & $2^{24.33}$ & $2^{25.85}$ & $11.22$ & $2^{50.19}$ \\
\end{tabular}
  \caption{DP Parameters}
  \label{tab:DPparam}
\end{table}

TODO Discuss table, graph..

TODO PARAMTER CHOICE?

\section{Rainbow Table}
\label{sec:rainbowparam}
For the Rainbow Table TMTO attack, we again set \code{8TB} as the
upper bound for memory consumption.

All calculations of parameters follows the theory provided in
\ref{sec:raintheory}.

Conveniently \cite[Fig.4]{176} shows that with our chosen success rate
$P$ the trade-off effiency is actually lowest when the table count is
set to 1.

In our calculations, we assume a sequential approach is done in the
pre-computational phase. This allows us to remove half of the memory
cost compared to storing both start point and end point.

As we have a chosen success rate $P$ set, \cite[Proposition
29]{176} shows that from a given $P$ we can calculate a lower bound
for $R_{msc}$ as follows
\[R_{ps} = 1 - \left( \frac{2}{2 + R_{msc}}^{2l} \right) \Rightarrow R_{msc} = 2 ((1 - R_{ps})^{-\frac{1}{2l}} - 1)\]
Where $R_{ps}$ is the success probability of a rainbow attack. With
that in mind we can now for different values of $m$ compute the
corresponding $t$ value where the $R_{msc}$ is satisfied.

Table \ref{tab:rainparam} shows the relation between \code{t} and
\code{m} in a Rainbow attack, when the success rate of $73\%$ is set\footnote{Tables for $P = 58\%, P = 73\%, P = 90\%$ and tables $l=1..3$ are generated and can be
found in Appendix \ref{sec:rainbowtab}.}. Figures \ref{fig:param73}
and \ref{fig:time73} shows the graphical representation of the table.

\begin{table}[H]
  \centering
  \text{\texttt{Success{ }={ }0.730000,{ }Rmsc{ }={ }1.849002,{ }l{ }={ }1,{ }Offline{ }phase{ }={ }2{\char`\^}64.886747}}
  \begin{tabular}{llll}
    m & t & M(TB) & T \\ \hline
    $2^{35.50}$ & $2^{29.39}$ & $0.39$ & $2^{56.58}$ \\
    $2^{36.00}$ & $2^{28.89}$ & $0.55$ & $2^{55.58}$ \\
    $2^{36.50}$ & $2^{28.39}$ & $0.78$ & $2^{54.58}$ \\
    $2^{37.00}$ & $2^{27.89}$ & $1.10$ & $2^{53.58}$ \\
    $2^{37.50}$ & $2^{27.39}$ & $1.55$ & $2^{52.58}$ \\
    $2^{38.00}$ & $2^{26.89}$ & $2.20$ & $2^{51.58}$ \\
    $2^{38.50}$ & $2^{26.39}$ & $3.11$ & $2^{50.58}$ \\
    $2^{39.00}$ & $2^{25.89}$ & $4.40$ & $2^{49.58}$ \\
    $2^{39.50}$ & $2^{25.39}$ & $6.22$ & $2^{48.58}$ \\
    $2^{39.80}$ & $2^{25.08}$ & $7.65$ & $2^{47.98}$ \\
    $2^{40.00}$ & $2^{24.89}$ & $8.80$ & $2^{47.58}$ \\
  \end{tabular}
  \caption{Rainbow Parameters}
  \label{tab:rainparam}
\end{table}
\begin{figure}[H]
  \centering
  \begin{minipage}{.5\textwidth}
    \centering
    \includegraphics[scale=0.3]{figures/RainbowCoef73.png}
    \captionof{figure}{Rainbow Parameters 73\% success}
    \label{fig:param73}
  \end{minipage}%
  \begin{minipage}{.5\textwidth}
    \centering
    \includegraphics[scale=0.3]{figures/RainbowTime73.png}
    \captionof{figure}{Rainbow TMTO 73\% success}
    \label{fig:time73}
  \end{minipage}
\end{figure}

TODO The descriptionssss!!! Looking at table \ref{tab:rainparam} and figures \ref{fig:param73}
and \ref{fig:time73}\footnote{See Appendix \ref{sec:rainbowgraphs} for
  full size graphs} while knowing that

\newpage
\section{Comparison and choice of table}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "Thesis"
%%% End:
